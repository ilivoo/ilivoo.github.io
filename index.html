<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Ilivoo`s blog" type="application/atom+xml" />






<meta name="description" content="我，在這裡，享受等你的時光。">
<meta property="og:type" content="website">
<meta property="og:title" content="Ilivoo`s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Ilivoo`s blog">
<meta property="og:description" content="我，在這裡，享受等你的時光。">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ilivoo`s blog">
<meta name="twitter:description" content="我，在這裡，享受等你的時光。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Ilivoo`s blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Ilivoo`s blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/29/hadoop-hive-usage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/29/hadoop-hive-usage/" itemprop="url">hive基本使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-29T10:06:48+08:00">
                2020-05-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">hadoop</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/hive/" itemprop="url" rel="index">
                    <span itemprop="name">hive</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,980
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="hive基本使用"><a href="#hive基本使用" class="headerlink" title="hive基本使用"></a>hive基本使用</h4><ul>
<li><p>hive3.0默认开启事务表，对于事务表支持CRUD和merge操作，并且只能是orc数据格式，也可以指定事务表为insert-only，但是支持所有的数据格式都支持，事务表现在不需要必须是分桶的。</p>
<ul>
<li><p>事务表为了CUD必须设置动态分区为 <code>nonstrict</code></p>
</li>
<li><p>事务每次修改都会导致产生大量小文件，默认hive会自动compact小文件，但是也可以手动进行compact</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE tablename [PARTITION (partition_key=&apos;partition_value&apos; [,...])] COMPACT &apos;compaction_type&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>DISTRIBUTE BY、SORT BY、CLUSTER BY</p>
<ul>
<li><p>如果想要把具有相同 Key 值的数据分发到同一个 Reducer 进行处理，这可以使用 DISTRIBUTE BY 字句。需要注意的是，DISTRIBUTE BY 虽然能把具有相同 Key 值的数据分发到同一个 Reducer，但是不能保证数据在 Reducer 上是有序的。</p>
</li>
<li><p>如果想让 单个Reducer 上的数据时有序的，可以结合 <code>SORT BY</code> 使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT empno, deptno, sal FROM emp DISTRIBUTE BY deptno SORT BY deptno ASC;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果 <code>SORT BY</code> 和 <code>DISTRIBUTE BY</code> 指定的是相同字段，且 SORT BY 排序规则是 ASC，此时可以使用 <code>CLUSTER BY</code> 进行替换，同时 <code>CLUSTER BY</code> 可以保证数据在全局是有序的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT empno, deptno, sal FROM emp CLUSTER  BY deptno;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>with 查询，Hive 可以通过with查询来提高查询性能。先通过with语法将重复使用的数据查询到内存，后面其它查询可以直接使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">with tmp as (select * from employee where name=&apos;ted&apos;)</span><br><span class="line">select * from tmp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>hive存在内部、外部、临时、分区、分桶和倾斜表，倾斜表是通过指定一个或者多个列经常出现的值（严重偏斜），Hive 会自动将涉及到这些值的数据拆分为单独的文件。在查询时，如果涉及到倾斜值，它就直接从独立文件中获取数据，而不是扫描所有文件，这使得性能得到提升。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE EXTERNAL TABLE emp_skewed(</span><br><span class="line">  empno INT,</span><br><span class="line">  ename STRING,</span><br><span class="line">  job STRING,</span><br><span class="line">  )</span><br><span class="line">  SKEWED BY (empno) ON (66,88,100)  --指定 empno 的倾斜值 66,88,100</span><br><span class="line">  ROW FORMAT DELIMITED FIELDS TERMINATED BY &quot;\t&quot;</span><br><span class="line">  LOCATION &apos;/hive/emp_skewed&apos;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>hive merge语法，对于事务表通过定时的ETL，可以将kafka或其它数据源中的数据迁移到hive当中，如增量获取维度数据，先用sqoop导入关系型数据到临时表，再执行下面语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">merge into base_table using incremental_table on base.id = incremental_table.id</span><br><span class="line">  when matched then update set</span><br><span class="line">       fieldl1=incremental_table.email,</span><br><span class="line">       modified_date=incremental_table.state</span><br><span class="line">  when not matched then insert</span><br><span class="line">       values(incremental_table.id, incremental_table.field1, incremental_table.modified_data);</span><br></pre></td></tr></table></figure>
</li>
<li><p>hive索引在3.0中已经取消，并且官方建议使用物化视图和列式存储来对表进行加速，其实对于数据仓库而言索引没有存在的必要，都是全表扫描。</p>
</li>
<li><p>hive调试 <code>hive --hiveconf hive.root.logger=INFO,console</code></p>
</li>
<li><p>表制作函数和lateral view，lateral view 与用户自定义表生成函数（UDTF）（例如 explode）结合使用，UDTF 为每个输入行生成零个或多个输出行。lateralview 首先将 UDTF 应用于基础表的每一行，然后将结果输出行与输入行连接起来形成具有所提供表别名的虚拟表。from 子句可以具有多个 lateralview 子句，多个laterval view进行笛卡尔乘积。如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select explode(array(&apos;A&apos;,&apos;B&apos;,&apos;C&apos;)) as col; //直接生成多行，列名为col</span><br><span class="line">select tf.* from (select 0) t lateral view explode(array(&apos;A&apos;,&apos;B&apos;,&apos;C&apos;)) tf;//tf虚拟表名</span><br><span class="line">select explode(map(&apos;A&apos;,10,&apos;B&apos;,20,&apos;C&apos;,30)) as (key,value);//直接生产多行，列名为key和value</span><br><span class="line">select tf.* from (select 0) t lateral view explode(map(&apos;A&apos;,10,&apos;B&apos;,20,&apos;C&apos;,30)) tf;</span><br></pre></td></tr></table></figure>
</li>
<li><p>hive增强聚合grouping sets、cube、rollup，在通常的group by中只是对当前指定的维度进行聚合，但是通常情况下可能需要同时对多个维度一次性聚合，那么就可以使用增强聚合，如维度为a和b，如下</p>
<p>| gruoping sets                                                | group                                                        |<br>| ———————————————————— | ———————————————————— |<br>| SELECT a, b, SUM( c ) FROM tab1 GROUP BY a, b GROUPING SETS ( (a, b), a, b, ( ) ) | SELECT a, b, SUM( c ) FROM tab1 GROUP BY a, b UNION SELECT a, null, SUM( c ) FROM tab1 GROUP BY a, null UNION SELECT null, b, SUM( c ) FROM tab1 GROUP BY null, b UNION SELECT null, null, SUM( c ) FROM tab1 |<br>| SELECT a, b, SUM( c ) FROM tab1 GROUP BY a, b GROUPING SETS ( (a,b), a) | SELECT a, b, SUM( c ) FROM tab1 GROUP BY a, b UNION SELECT a, null, SUM( c ) FROM tab1 GROUP BY a |<br>| SELECT a, b, SUM(c) FROM tab1 GROUP BY a, b GROUPING SETS ( (a,b) ) | SELECT a, b, SUM(c) FROM tab1 GROUP BY a, b                  |<br>| SELECT a,b, SUM( c ) FROM tab1 GROUP BY a, b GROUPING SETS (a,b) | SELECT a, null, SUM( c ) FROM tab1 GROUP BY a UNION SELECT null, b, SUM( c ) FROM tab1 GROUP BY b |</p>
<p><strong>说明：</strong>对于cube是直接进行笛卡尔乘积，如grouping sets ( (a, b), a, b, ( ) ) = cube(a, b)，而rollup是向上，如</p>
<p>grouping sets ( (a, b), a, ( ) ) = rollup(a, b)</p>
</li>
<li><p>cost-based optimizer (CBO)，hive默认开启CBO优化，并且自动生成表级别的统计信息，但是hive并不会使用CBO优化，知道为表生成了列统计信息，hive并没有默认执行列统计信息，因为统计列信息可能需要大量的计算。</p>
</li>
</ul>
<h4 id="窗口和分析函数"><a href="#窗口和分析函数" class="headerlink" title="窗口和分析函数"></a>窗口和分析函数</h4><ul>
<li><p>窗口函数和分组group最大的区别在于，分组只是为当前分区计算出单个值，而窗口函数是对窗口进行分组，并且分析函数计算出窗口中每一行的一个值，这个值通常是一个累加的结果。</p>
</li>
<li><p>窗口函数over是为了对数据划分窗口，over(partition by 列名 order by 列名 rows between 开始位置 and 结束位置)</p>
<ul>
<li><p>over()函数中的分区、排序、指定窗口范围可组合使用也可以不指定，根据不同的业务需求结合使用</p>
</li>
<li><p>over()函数中如果不指定分区，窗口大小是针对查询产生的所有数据，如果指定了分区，窗口大小是针对每个分区的数据</p>
</li>
<li><p>范围</p>
<ul>
<li><p>current row：当前行</p>
</li>
<li><p>unbounded：起点，unbounded preceding 表示从前面的起点， unbounded following表示到后面的终点</p>
</li>
<li><p>n preceding ：往前n行数据</p>
</li>
<li><p>n following：往后n行数据</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>常用的分析函数</p>
<ul>
<li>聚合类<br> avg()、sum()、max()、min()</li>
<li>排名类<br> row_number()  按照值排序时产生一个自增编号，不会重复<br> rank() 按照值排序时产生一个自增编号，值相等时会重复，会产生空位<br> dense_rank() 按照值排序时产生一个自增编号，值相等时会重复，不会产生空位</li>
<li>其他类<br> lag(列名,往前的行数,[行数为null时的默认值，不指定为null])<br> lead(列名,往后的行数,[行数为null时的默认值，不指定为null])<br> ntile(n) 把有序分区中的行分发到指定数据的组中，各个组有编号，编号从1开始，对于每一行，ntile返  回此行所属的组的编号</li>
</ul>
</li>
</ul>
<h4 id="物化视图"><a href="#物化视图" class="headerlink" title="物化视图"></a>物化视图</h4><ul>
<li><p>物化视图是一种预计算的优化方式，通过预先计算并保存表连接或聚合等耗时较多的操作的结果，这样在查询的时候就可以避免进行这些耗时的操作，从而快速得到结果。</p>
</li>
<li><p>物化视图使用的是查询语句重写机制，不需要修改原有的查询语句，优化引擎自动选择合适的物化视图进行查询，对用户完全透明。它和视图的区别在于，物化视图将存储实际的数据，而视图只是存储SQL语句。</p>
</li>
<li><p>物化视图的使用</p>
<ul>
<li><p>创建物化视图，类似创建表可以指定handler，将物化视图存储在其它存储设备，如druid</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CREATE MATERIALIZED VIEW [IF NOT EXISTS] [db_name.]materialized_view_name</span><br><span class="line">  [DISABLE REWRITE]</span><br><span class="line">  [COMMENT materialized_view_comment]</span><br><span class="line">  [PARTITIONED ON (col_name, ...)]</span><br><span class="line">  [</span><br><span class="line">    [ROW FORMAT row_format]</span><br><span class="line">    [STORED AS file_format]</span><br><span class="line">      | STORED BY &apos;storage.handler.class.name&apos; [WITH SERDEPROPERTIES (...)]</span><br><span class="line">  ]</span><br><span class="line">  [LOCATION hdfs_path]</span><br><span class="line">  [TBLPROPERTIES (property_name=property_value, ...)]</span><br><span class="line">AS SELECT ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改物化视图对优化器重写优化plan（全局默认是开启）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SET hive.materializedview.rewriting=true;</span><br><span class="line">ALTER MATERIALIZED VIEW [db_name.]materialized_view_name ENABLE|DISABLE REWRITE;</span><br></pre></td></tr></table></figure>
</li>
<li><p>源数据表增加数据时，物化视图也需要更新以保持数据一致性，目前需要用户主动触发rebuild</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER MATERIALIZED VIEW [db_name.]materialized_view_name REBUILD;</span><br></pre></td></tr></table></figure>
</li>
<li><p>物化视图生命周期，可以设定指定的窗口时间内物化视图会起到优化作用，超过时间就设置物化视图无效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET hive.materializedview.rewriting.time.window=10min;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>物化视图和视图的在数据仓库的使用</p>
<ul>
<li>DM通常情况下视图使用在DM（数据集市层），下层的DW（DWD/DWS）数据仓库层使用的是维度建模，这样在DM层就是一个完整的视图层，可以通过反范式的方式将DW层的数据进行合并到一张表，从而形成一个数据集市的主体域。由此可见物化视图在消除连接和进行提前聚合方面是非常有用的。</li>
</ul>
</li>
</ul>
<h4 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h4><ul>
<li><p>hive支持隐式连接，也就是在from后面添加多张表进行连接操作，并且从hive2.2开始已经支持不等值连接。</p>
</li>
<li><p>hive目前存在三种join实现方式，shuffle join、broadcast join、sort-merge-bucket join，分别对于关系型数据库中的三种join，hash join、nested-loop join、sort-merge join（先排序再merge join），当然hive中的sort-merge-bucket join稍微有些扩展，因为hive中支持bucket（每个bucket就可以看做是一个小表），所以如果两个表相同的cluster列的bucket成倍数，那么就可以完全将两个表的bucket对应上，这样就想到于各个小表进行sort-merge排序，当然必须保证bucket上已经进行了排序，设置如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">set hive.auto.convert.sortmerge.join=true;</span><br><span class="line">set hive.optimize.bucketmapjoin = true;</span><br><span class="line">set hive.optimize.bucketmapjoin.sortedmerge = true;</span><br><span class="line">set hive.auto.convert.sortmerge.join.bigtable.selection.policy </span><br><span class="line">    = org.apache.hadoop.hive.ql.optimizer.TableSizeBasedBigTableSelectorForAutoSMJ(d);</span><br><span class="line">    = org.apache.hadoop.hive.ql.optimizer.LeftmostBigTableSelectorForAutoSMJ</span><br><span class="line">    = org.apache.hadoop.hive.ql.optimizer.TableSizeBasedBigTableSelectorForAutoSMJ</span><br></pre></td></tr></table></figure>
<p>当然每种属性都可以独立设置，可以只进行bucketmapjoin等等</p>
</li>
<li><p>hive只能进行等值连接（hive 2.2 之后可以不等值连接），不能进行不等值连接，只支持等值链接，支持 and，不支持 or，这是因为MapReduce实现不等值连接非常困难，所以对于连接中的不等条件只能提取出来，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from (select o.*, u.* from ops_oder as o join dwd_dim_user as u on o.user_id = u.user_id) where create_time &gt;= start_date and create_time &lt;= end_date</span><br></pre></td></tr></table></figure>
</li>
<li><p>HiveJoin 分三种：inner join, outer join, semi join，outer join 包括 left join，right join 和 full outer join,主要用来处理 join 中空记录的情况，semi join是用来判断存在的，是in/exist的一种高效实现方式，也就是投影只包含左边表，右边表只是用来等值判断的</p>
</li>
<li><p>hive多表连接时，如果on后面的条件是同样的字段，则会自动优化为一个MapReduce任务</p>
</li>
<li><p>等值连接的每个值都可以使用函数进行返回值（包括不等值函数），如解决数据倾斜</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM log a LEFT OUTER </span><br><span class="line">JOIN bmw_users b ON </span><br><span class="line">CASE WHEN a.user_id IS NULL THEN CONCAT(‘dp_hive’,RAND()) ELSE a.user_id END =b.user_id;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在编写带有 join 操作的代码语句时，应该将条目少的表/子查询放在 Join 操作符的左边。 因为在 Reduce 阶段，位于 Join 操作符左边的表的内容会被加载进内存，载入条目较少的表 可以有效减少 OOM（out of memory）即内存溢出。所以对于同一个 key 来说，对应的 value 值小的放前，大的放后，这便是“小表放前”原则。 hive也提供了<code>STREAMTABLE</code>大表标识，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT /*+ STREAMTABLE(d) */  e.*,d.* FROM emp e JOIN dept d ON e.no = d.no</span><br></pre></td></tr></table></figure>
</li>
<li><p>map Join 操作在 Map 阶段完成，不再需要Reduce，前提条件是需要的数据在 Map 的过程中可以访问到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INSERT OVERWRITE TABLE pv_users </span><br><span class="line">   SELECT /*+ MAPJOIN(pv) */ pv.pageid, u.age </span><br><span class="line">   FROM page_view pv JOIN user u ON (pv.userid = u.userid);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>  map join还可以设置成自动优化，就不需要设置map join了，配置如下：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set hive.auto.convert.join.noconditionaltask = true;</span><br><span class="line">set hive.auto.convert.join.noconditionaltask.size = 10000000;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>cross join 笛卡尔乘积，笛卡尔乘积不需要指定连接键，因为两张表会做一个乘积。通常情况下笛卡尔乘积不会使用到，但是对于想要为某个表查询的时候添加一个列，此时就可以使用到了，如生产自增id。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into tbl_dim </span><br><span class="line">        select row_number() over (order by tbl_stg.tm) + t2.sk_max, tbl_stg.* from tbl_stg</span><br><span class="line">        cross join </span><br><span class="line">        (select coalesce(max(sk),0) sk_max from tbl_dim) t2;</span><br></pre></td></tr></table></figure>
<p><strong>说明：</strong>此处是给维度表添加新增加的维度数据，自增的id就是维度表的代理键。</p>
</li>
</ul>
<h4 id="数据倾斜"><a href="#数据倾斜" class="headerlink" title="数据倾斜"></a>数据倾斜</h4><ul>
<li><p>问题1，日志中常会出现信息丢失，比如每日约为 20 亿的全网日志，其中的 user_id 为主 键，在日志收集过程中会丢失，出现主键为 null 的情况，如果取其中的 user_id 和 bmw_users 关联，就会碰到数据倾斜的问题。原因是 Hive 中，主键为 null 值的项会被当做相同的 Key 而分配进同一个计算 Map</p>
<ul>
<li><p>解决方法 1：user_id 为空的不参与关联，子查询过滤 null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM log a </span><br><span class="line">JOIN bmw_users b ON a.user_id IS NOT NULL AND a.user_id=b.user_id </span><br><span class="line">UNION All SELECT * FROM log a WHERE a.user_id IS NULL</span><br></pre></td></tr></table></figure>
</li>
<li><p>解决方法 2 如下所示：函数过滤 null </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM log a LEFT OUTER </span><br><span class="line">JOIN bmw_users b ON </span><br><span class="line">CASE WHEN a.user_id IS NULL THEN CONCAT(‘dp_hive’,RAND()) ELSE a.user_id END =b.user_id;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通常解决方法2比解决方法1效果更好，不但IO少了，而且作业数也少了。解决方法1中log读取两次，job 数为2。解决方法2中 job 数是1。这个优化适合无效 id（比如-99、 ‘’，null 等）产生的倾斜问题。把空值的 key 变成一个字符串加上随机数，就能把倾斜的 数据分到不同的Reduce上，从而解决数据倾斜问题。因为空值不参与关联，即使分到不同 的 Reduce 上，也不会影响最终的结果。附上 Hadoop 通用关联的实现方法是：关联通过二次排序实现的，关联的列为 partion key，关联的列和表的<br>tag 组成排序的 group key，根据 pariton key分配Reduce。同一Reduce内根据group key排序。</p>
</li>
</ul>
</li>
</ul>
<h4 id="动态分区"><a href="#动态分区" class="headerlink" title="动态分区"></a>动态分区</h4><ul>
<li><p>动态分区插入（或多分区插入）旨在通过动态确定在扫描输入表时应创建和填充哪些分区来解决此问题。在动态分区插入中，将评估输入列的值，以确定应将此行插入哪个分区。如果尚未创建该分区，它将自动创建该分区。使用此功能，您只需一个插入语句即可创建并填充所有必要的分区。另外，由于只有一个insert语句，因此只有一个对应的MapReduce作业。与多次插入的情况相比，这显著提高了性能并减少了Hadoop集群的工作量。</p>
</li>
<li><p>由于动态分区存在一些限制，所以操作之前需要设置为 nostrict</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set hive.exec.dynamic.partition=true;</span><br><span class="line">set hive.exec.dynamic.partition.mode=nonstrict;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><ul>
<li><p>hive中存在各种内建操作符和对应类型操作的函数，<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF" target="_blank" rel="noopener">参考</a></p>
</li>
<li><p>条件函数</p>
<p>| 返回值  | 方法名                                                     | 描述                                                         |<br>| ——- | ———————————————————- | ———————————————————— |<br>| boolean | isnull( a )                                                | Returns true if a is NULL and false otherwise.               |<br>| boolean | isnotnull ( a )                                            | Returns true if a is not NULL and false otherwise.           |<br>| T       | if(boolean testCondition, T valueTrue, T valueFalseOrNull) | Returns valueTrue when testCondition is true, returns valueFalseOrNull otherwise. |<br>| T       | nvl(T value, T default_value)                              | Returns default value if value is null else returns value    |<br>| T       | COALESCE(T v1, T v2, …)                                  | Returns the first v that is not NULL, or NULL if all v’s are NULL. |<br>| T       | CASE a WHEN b THEN c [WHEN d THEN e]<em> [ELSE f] END         | When a = b, returns c; when a = d, returns e; else returns f. |<br>| T       | CASE WHEN a THEN b [WHEN c THEN d]</em> [ELSE e] END           | When a = true, returns b; when c = true, returns d; else returns e. |<br>| T       | nullif( a, b )                                             | Returns NULL if a=b; otherwise returns a Shorthand for: CASE WHEN a = b then NULL else a |<br>| void    | assert_true(boolean condition)                             | Throw an exception if ‘condition’ is not true, otherwise return null |</p>
</li>
<li><p>数据屏蔽函数（创建视图时候防止信息泄露）</p>
</li>
<li><p>常用的其它函数</p>
<p>| 返回值 | 方法名                                              |<br>| —— | ————————————————— |<br>| varies | java_method(class, method[, arg1[, arg2..]])        |<br>| varies | reflect(class, method[, arg1[, arg2..]])            |<br>| int    | hash(a1[, a2…])                                   |<br>| string | current_user()                                      |<br>| string | logged_in_user()                                    |<br>| string | current_database()                                  |<br>| string | md5(string/binary)                                  |<br>| string | sha1(string/binary)sha(string/binary)               |<br>| bigint | crc32(string/binary)                                |<br>| string | sha2(string/binary, int)                            |<br>| binary | aes_encrypt(input string/binary, key string/binary) |<br>| binary | aes_decrypt(input binary, key string/binary)        |<br>| string | version()                                           |<br>| bigint | surrogate_key([write_id_bits, task_id_bits])        |</p>
</li>
<li><p>get_json_object，支持四种最基本形式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ : Root object</span><br><span class="line">. : Child operator</span><br><span class="line">[] : Subscript operator for array</span><br><span class="line">* : Wildcard for []</span><br></pre></td></tr></table></figure>
<p>如：<code>SELECT get_json_object(src_json.json, `</code>‘$.owner’<code></code>) FROM src_json;`</p>
</li>
<li><p>聚合函数</p>
<p>| 返回值                    | 方法名                                                   | 描述                                                         |<br>| ————————- | ——————————————————– | ———————————————————— |<br>| BIGINT                    | count(<em>), count(expr), count(DISTINCT expr[, expr…])   | count(</em>) - Returns the total number of retrieved rows, including rows containing NULL values.count(expr) - Returns the number of rows for which the supplied expression is non-NULL.count(DISTINCT  expr[, expr]) - Returns the number of rows for which the supplied  expression(s) are unique and non-NULL. Execution of this can be  optimized with <a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.optimize.distinct.rewrite" target="_blank" rel="noopener">hive.optimize.distinct.rewrite</a>. |<br>| DOUBLE                    | sum(col), sum(DISTINCT col)                              | Returns the sum of the elements in the group or the sum of the distinct values of the column in the group. |<br>| DOUBLE                    | avg(col), avg(DISTINCT col)                              | Returns the average of the elements in the group or the average of the distinct values of the column in the group. |<br>| DOUBLE                    | min(col)                                                 | Returns the minimum of the column in the group.              |<br>| DOUBLE                    | max(col)                                                 | Returns the maximum value of the column in the group.        |<br>| DOUBLE                    | variance(col), var_pop(col)                              | Returns the variance of a numeric column in the group.       |<br>| DOUBLE                    | var_samp(col)                                            | Returns the unbiased sample variance of a numeric column in the group. |<br>| DOUBLE                    | stddev_pop(col)                                          | Returns the standard deviation of a numeric column in the group. |<br>| DOUBLE                    | stddev_samp(col)                                         | Returns the unbiased sample standard deviation of a numeric column in the group. |<br>| DOUBLE                    | covar_pop(col1, col2)                                    | Returns the population covariance of a pair of numeric columns in the group. |<br>| DOUBLE                    | covar_samp(col1, col2)                                   | Returns the sample covariance of a pair of a numeric columns in the group. |<br>| DOUBLE                    | corr(col1, col2)                                         | Returns the Pearson coefficient of correlation of a pair of a numeric columns in the group. |<br>| DOUBLE/百分位数           | percentile(BIGINT col, p)                                | Returns the exact pth  percentile of a column in the group (does not work with floating point  types). p must be between 0 and 1. NOTE: A true percentile can only be  computed for integer values. Use PERCENTILE_APPROX if your input is  non-integral. |<br>| array<double>             | percentile(BIGINT col, array(p1 [, p2]…))              | Returns the exact percentiles p1, p2, … of a column in the group (does not work with floating point types). pi  must be between 0 and 1. NOTE: A true percentile can only be computed  for integer values. Use PERCENTILE_APPROX if your input is non-integral. |<br>| DOUBLE                    | percentile_approx(DOUBLE col, p [, B])                   | Returns an approximate pth  percentile of a numeric column (including floating point types) in the  group. The B parameter controls approximation accuracy at the cost of  memory. Higher values yield better approximations, and the default is  10,000. When the number of distinct values in col is smaller than B,  this gives an exact percentile value. |<br>| array<double>             | percentile_approx(DOUBLE col, array(p1 [, p2]…) [, B]) | Same as above, but accepts and returns an array of percentile values instead of a single one. |<br>| array&lt;struct {<code>&#39;x&#39;,&#39;y&#39;</code>}&gt; | histogram_numeric(col, b)                                | Computes  a histogram of a numeric column in the group using b non-uniformly  spaced bins. The output is an array of size b of double-valued (x,y)  coordinates that represent the bin centers and heights |<br>| array                     | collect_set(col)                                         | Returns a set of objects with duplicate elements eliminated. |<br>| array                     | collect_list(col)                                        | Returns a list of objects with duplicates. (As of Hive <a href="https://issues.apache.org/jira/browse/HIVE-5294" target="_blank" rel="noopener">0.13.0</a>.) |<br>| INTEGER                   | ntile(INTEGER x)                                         | Divides an ordered partition into <code>x</code> groups called buckets and assigns a bucket number to each row in the partition. This allows easy calculation of tertiles, quartiles, deciles, percentiles and other common summary statistics. (As of Hive <a href="https://issues.apache.org/jira/browse/HIVE-896" target="_blank" rel="noopener">0.11.0</a>.) |</double></double></p>
</li>
<li><p>表生成函数</p>
<p>| 返回值               | 方法名                                                 | 描述                                                         |<br>| ——————– | —————————————————— | ———————————————————— |<br>| T                    | explode(ARRAY<t> a)                                    | Explodes an array to multiple rows. Returns a row-set with a single column (<em>col</em>), one row for each element from the array. |<br>| Tkey,Tvalue          | explode(MAP&lt;Tkey,Tvalue&gt; m)                            | Explodes a map to multiple rows. Returns  a row-set with a two columns (<em>key,value)</em> , one row for each key-value pair from the input map. (As of Hive <a href="https://issues.apache.org/jira/browse/HIVE-1735" target="_blank" rel="noopener">0.8.0</a>.). |<br>| int,T                | posexplode(ARRAY<t> a)                                 | Explodes an array to multiple rows with additional positional column of <em>int</em> type (position of items in the original array, starting with 0). Returns a row-set with two columns (<em>pos,val</em>), one row for each element from the array. |<br>| T1,…,Tn            | inline(ARRAY&lt;STRUCT<a href="f1:T1,...,fn:Tn" target="_blank" rel="noopener">f1:T1,...,fn:Tn</a>&gt; a)               | Explodes an array of structs to multiple rows. Returns  a row-set with N columns (N = number of top level elements in the struct), one row per struct from the array. (As of Hive <a href="https://issues.apache.org/jira/browse/HIVE-3238" target="_blank" rel="noopener">0.10</a>.) |<br>| T1,…,Tn/r          | stack(int r,T1  V1,…,Tn/r Vn)                        | Breaks up <em>n</em> values V1,…,Vn into <em>r</em> rows. Each row will have <em>n/r</em> columns. <em>r</em> must be constant. |<br>| string1,…,stringn  | json_tuple(string jsonStr,string k1,…,string kn)     | Takes JSON string and a set of <em>n</em> keys, and returns a tuple of <em>n</em> values. This is a more efficient version of the <code>get_json_object</code> UDF because it can get multiple keys with just one call. |<br>| string 1,…,stringn | parse_url_tuple(string urlStr,string p1,…,string pn) | Takes URL string and a set of <em>n</em> URL parts, and returns a tuple of <em>n</em> values. This is similar to the <code>parse_url()</code>  UDF but can extract multiple parts at once out of a URL. Valid part  names are: HOST, PATH, QUERY, REF, PROTOCOL, AUTHORITY, FILE, USERINFO,  QUERY:<key>. |</key></t></t></p>
</li>
</ul>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/09/hadoop-ssl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/09/hadoop-ssl/" itemprop="url">hadoop-ssl</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-09T15:01:01+08:00">
                2020-05-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">hadoop</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/ssl/" itemprop="url" rel="index">
                    <span itemprop="name">ssl</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  473
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="常见SSL认知"><a href="#常见SSL认知" class="headerlink" title="常见SSL认知"></a>常见SSL认知</h4><ul>
<li>双认证形式，如：nifi，双方都生产各自的keystone，并导出包含自己证书的truststore，再将truststore互换即可进行通讯，如果服务端会有多个客户端连接，那么服务端的truststore需要加入客户端的证书，并且客户端truststore也需要导入服务端的证书，最终就导致服务端的truststore包含多条信任的证书。</li>
<li>单认证形式，如：flume，服务端需要验证客户端，客户端不需要验证服务端，服务端生成keystone，并导出truststore给客户端即可通讯，如果服务端会有多个客户端连接，那么服务端的keystone需要再导入一个新生成的keystone，并把这个keystone的truststore导入给客户端即可。</li>
<li>在JKS中，keystone和truststore本质上是同一种类型文件，都是用来存放私钥和公钥以及证书的，只是为了方便使用，将keystone用来存放秘钥，将truststore存放信任的证书。</li>
<li>合并Keystone和truststore添加证书不需要重启服务器。</li>
</ul>
<h4 id="keytool工具使用"><a href="#keytool工具使用" class="headerlink" title="keytool工具使用"></a>keytool工具使用</h4><ul>
<li><p>生成keystone，其中存放私钥和公钥的证书</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -alias feng  -keyalg RSA -keysize 2048 -validity 10950  -keystore keystore.jks -dname &quot;CN=feng, OU=software, O=tepia.com, L=wuhan, ST=hubei, C=CN&quot; -keypass 123456 -storepass 123456</span><br></pre></td></tr></table></figure>
<ul>
<li>OU表示组织内的单元，也就是组织的部门</li>
<li>keypass表示秘钥的密码，可以和storepass相同</li>
<li>storepass表示keystone容器的密码</li>
</ul>
</li>
<li><p>导出证书</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -export -alias feng -keystore keystore.jks -rfc -file feng.cer -storepass 123456</span><br></pre></td></tr></table></figure>
</li>
<li><p>将证书导入到truststore</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -import -alias feng  -file feng.cer  -keystore truststore.jks</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看keystone或truststore中的秘钥或证书</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -v -keystore keystore.jks</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看证书信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -printcert -file feng.cer</span><br></pre></td></tr></table></figure>
</li>
<li><p>keystone中添加一个keystone（添加私钥和公钥证书）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -importkeystore -srckeystore xiang/keystore.jks -destkeystore keystore.jks</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除证书或这私钥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -delete -alias xiang -keystore keystore.jks</span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/20/hadoop-hortonwork-sandbox/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/20/hadoop-hortonwork-sandbox/" itemprop="url">hadoop-hortonwork-sandbox</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-04-20T11:53:57+08:00">
                2020-04-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">hadoop</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/hortonwork/" itemprop="url" rel="index">
                    <span itemprop="name">hortonwork</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  514
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>安装的过程中会出现端口冲突，直接修改 <code>sandbox/proxy/proxy-deploy.sh</code> 配置就可了， 如：</p>
<p><code>-p 31080 1080 \</code></p>
</li>
<li><p>修改docker 的root密码, 直接登录进入docker就会提示更改密码</p>
</li>
<li><p>更改ambari admin 密码， 终端下执行 ambari-admin-password-reset</p>
</li>
<li><p>mysql无法启动</p>
<p><code>mv /usr/sbin/mysqld /usr/bin/mysqld</code></p>
<p><code>ln -nfs /usr/bin/mysqld /usr/sbin/mysqld</code></p>
</li>
<li><p>修改hdfs的yarn日志用户, Ambari &gt; HDFS &gt; Configurations&gt;custorm core-site &gt; Add Property</p>
<p><code>hadoop.http.staticuser.user = yarn</code></p>
</li>
<li><p>修改ranger admin UI密码登入， 保持下面密码全部都是一样的， 并且密码长度大于等于9位</p>
<ul>
<li><p>注意： 设置ranger的rangerdba连接的时候要明确指定不需要SSL，如下：</p>
<p><code>jdbc:mysql://hdp1.ilivoo.com:3306?useSSL=false</code></p>
</li>
<li><p>更改ambari admin 密码， 终端下执行 ambari-admin-password-reset</p>
</li>
<li><p>更改ranger admin for Ambari密码， ranger -&gt; config -&gt; advance -&gt; Ranger Admin user’s password for Ambari(Admin Settings下)</p>
</li>
<li><p>更改ranger Admin 密码， ranger -&gt; config -&gt; advance -&gt; Ranger Admin user’s password(Ranger-env下)</p>
</li>
<li><p>更改mysql root用户以方便以后对mysql的更改， 在my.conf中加入skip-grant-tables跳过授权，更改mysql root用户密码</p>
<p><code>update mysql.user set authentication_string=password(&#39;mypasswd&#39;) where user=&#39;root&#39;;</code></p>
</li>
<li><p>更改ranger需要的mysql root账户密码， ranger -&gt; config -&gt; ranger admin -&gt; Database Administrator (DBA) password</p>
</li>
<li><p>更改ranger admin账户的登录密码 </p>
<p><code>update ranger.x_portal_user set password = &#39;ceb4f32325eda6142bd65215f4c0f371&#39; where login_id= &#39;admin&#39;;</code></p>
<p>此password是有用户名和密码进行MD5求取出来的</p>
<p><code>echo -n &#39;password{admin}&#39; | md5sum</code></p>
</li>
<li><p>使用同样(f步骤)的方法更改amb_ranger_admin的登录密码</p>
</li>
</ul>
</li>
<li><p>修改 Atlas admin密码</p>
<p><code>Configs-&gt; Advanced -&gt; Advanced atlas-env -&gt; Admin password</code></p>
</li>
<li><p>mysql 相关配置</p>
<p><code>max_connect_errors=10000</code></p>
<p><code>validate_password=OFF</code></p>
</li>
<li><p>修改sandbox-proxy， 让其暴露出kerberos认证需要的三个端口</p>
<ul>
<li>修改 <code>sandbox/proxy/proxy-deploy.sh</code>  添加如下内容：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-p 749:749 \</span><br><span class="line">-p 464:464 \</span><br><span class="line">-p 88:88 \</span><br></pre></td></tr></table></figure>
<ul>
<li>修改 <code>sandbox/proxy/conf.stream.d/tcp-hdp.conf</code> 添加如下内容：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 749;</span><br><span class="line">  proxy_pass sandbox-hdp:749;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen 464;</span><br><span class="line">  proxy_pass sandbox-hdp:464;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen 88;</span><br><span class="line">  proxy_pass sandbox-hdp:88;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 由于kerberos需要的是tcp端口， 所以我们只需要该tcp的配置就可以了， 如果需要http端口则可以修改http配置</p>
</li>
</ol>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/17/linux-aria2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/17/linux-aria2/" itemprop="url">linux-aria2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-04-17T19:30:42+08:00">
                2020-04-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  553
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>安装epel</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br><span class="line">rpm -ivh epel-release-latest-7.noarch.rpm</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装Aria2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install aria2</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建配置文件并编辑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/aria2/   #创建目录</span><br><span class="line">vi /etc/aria2/aria2.conf   #创建配置文件</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#用户名</span><br><span class="line">#rpc-user=user</span><br><span class="line">#密码</span><br><span class="line">#rpc-passwd=passwd</span><br><span class="line">#上面的认证方式不建议使用,建议使用下面的token方式</span><br><span class="line">#设置token</span><br><span class="line">rpc-secret=token</span><br><span class="line">#允许rpc</span><br><span class="line">enable-rpc=true</span><br><span class="line">#允许所有来源, web界面跨域权限需要</span><br><span class="line">rpc-allow-origin-all=true</span><br><span class="line">#允许外部访问，false的话只监听本地端口</span><br><span class="line">rpc-listen-all=true</span><br><span class="line">#RPC端口, 仅当默认端口被占用时修改</span><br><span class="line">rpc-listen-port=6800</span><br><span class="line">#最大同时下载数(任务数), 路由建议值: 3</span><br><span class="line">max-concurrent-downloads=5</span><br><span class="line">#断点续传</span><br><span class="line">continue=true</span><br><span class="line">#同服务器连接数</span><br><span class="line">max-connection-per-server=5</span><br><span class="line">#最小文件分片大小, 下载线程数上限取决于能分出多少片, 对于小文件重要</span><br><span class="line">min-split-size=10M</span><br><span class="line">#单文件最大线程数, 路由建议值: 5</span><br><span class="line">split=10</span><br><span class="line">#下载速度限制</span><br><span class="line">max-overall-download-limit=0</span><br><span class="line">#单文件速度限制</span><br><span class="line">max-download-limit=0</span><br><span class="line">#上传速度限制</span><br><span class="line">max-overall-upload-limit=0</span><br><span class="line">#单文件速度限制</span><br><span class="line">max-upload-limit=0</span><br><span class="line">#断开速度过慢的连接</span><br><span class="line">#lowest-speed-limit=0</span><br><span class="line">#验证用，需要1.16.1之后的release版本</span><br><span class="line">#referer=*</span><br><span class="line">#文件保存路径, 默认为当前启动位置</span><br><span class="line">dir=/root/downloads</span><br><span class="line">#文件缓存, 使用内置的文件缓存, 如果你不相信Linux内核文件缓存和磁盘内置缓存时使用</span><br><span class="line">#disk-cache=0</span><br><span class="line">#另一种Linux文件缓存方式</span><br><span class="line">enable-mmap=true</span><br><span class="line">#文件预分配, 能有效降低文件碎片, 提高磁盘性能. 缺点是预分配时间较长</span><br><span class="line">file-allocation=falloc</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装httpd</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum  -y  install  httpd</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取前端UI</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ziahamza/webui-aria2</span><br><span class="line">mv webui-aria2 /var/www/html/</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试aria2安装是否成功</p>
<ul>
<li><p>启动 <code>aria2c  --enable-rpc  --rpc-listen-all</code></p>
</li>
<li><p>浏览器打开 <code>http://localhost/webui-aria2/docs</code> ，成功连接表示没有问题</p>
</li>
</ul>
</li>
<li><p>正式启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aria2c --conf-path=/etc/aria2/aria2.conf -D</span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/23/java-unicode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/23/java-unicode/" itemprop="url">java 字符编码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-23T15:11:24+08:00">
                2019-12-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,949
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>Unicode基本介绍</p>
<ul>
<li>Unicode和UTF-8/UTF-16/UTF-32之间就是字符集和编码的关系。字符集的概念实际上包含两个方面，一个是字符的集合，一个是编码方案。</li>
<li>字符集定义了它所包含的所有符号，狭义上的字符集并不包含编码方案，它仅仅是定义了属于这个字符集的所有符号。但通常来说，一个字符集并不仅仅定义字符集合，它还为每个符号定义一个二进制编码。当我们提到GB2312或者ASCII的时候，它隐式地指明了编码方案是GB2312或者ASCII，在这些情况下可以认为字符集与编码方案互等。</li>
<li>但是Unicode具有多种编码方案。Unicode字符集规定的标准编码方案是UCS-2（UTF-16），用两个字节表示一个Unicode字符（UTF-16中两个字节的为基本多语言平面字符，4个字节的为辅助平面字符）。而UCS-4(UTF-32）用4个字节表示一个Unicode字符。另外一个常用的Unicode编码方案–UTF-8用1到4个变长字节来表示一个Unicode字符，并可以从一个简单的转换算法从UTF-16直接得到。所以在使用Unicode字符集时有多种编码方案，分别用于合适的场景。</li>
<li>再通俗一点地讲，Unicode字符集就相当于是一本字典，里面记载着所有字符以及各自所对应的Unicode码（与具体编码方案无关），UTF-8/UTF-16/UTF-32码就是Unicode码经过相应的公式计算得到的并且实际存储、传输的数据。</li>
</ul>
</li>
<li><p>UTF-16，JVM规范中明确说明了java的char类型使用的编码方案是UTF-16，所以先来了解下UTF-16。</p>
<ul>
<li><p>Unicode的编码空间从U+0000到U+10FFFF，共有1112064个码位(code point)可用来映射字符，码位就是字符的数字形式, 一共占int类型数值的低21位。这部分编码空间可以划分为17个平面， 由前面的U+00 - U+10来表示, 每个平面包含2^16（65536）个码位， 由后面的U+0000 - U+FFFF表示。第一个平面称为基本多语言平面（Basic Multilingual Plane, BMP），或称第零平面（Plane 0）。其他平面称为辅助平面（Supplementary Planes）。基本多语言平面内，从U+D800到U+DFFF之间的码位区块是永久保留不映射到Unicode字符。UTF-16就利用保留下来的0xD800-0xDFFF区段的码位来对辅助平面的字符的码位进行编码。</p>
</li>
<li><p>所谓基本语言平面就是将所有语言中比较常用的字符放在这个小的字符集当中， 其它比较复杂的字符使用辅助平面来进行编码， 这样就能保证常见字符的效率， 并且能够兼顾空间。</p>
</li>
<li><p>最常用的字符都包含在BMP中，用2个字节表示。辅助平面中的码位，在UTF-16中被编码为一对16比特长的码元，称作代理对（surrogate pair），具体方法是：</p>
<ul>
<li>将码位减去0x10000,得到的值的范围为20比特长的0~0xFFFFF。</li>
<li>高位的10比特的值（值的范围为0~0x3FF）被加上0xD800得到第一个码元或称作高位代理（high surrogate），值的范围是0xD800~0xDBFF=1024.由于高位代理比低位代理的值要小，所以为了避免混淆使用，Unicode标准现在称高位代理为前导代理（lead surrogates）。</li>
<li>低位的10比特的值（值的范围也是0~0x3FF）被加上0xDC00得到第二个码元或称作低位代理（low surrogate），现在值的范围是0xDC00~0xDFFF=1024.由于低位代理比高位代理的值要大，所以为了避免混淆使用，Unicode标准现在称低位代理为后尾代理（trail surrogates）。</li>
<li>例如U+10437编码:<ol>
<li>0x10437减去0x10000(最小的补充字符， 比基本平面最大值大1， 0x10000 = 0xFFFF + 1), 结果为0x00437, 二进制为0000 0000 0100 0011 0111。</li>
<li>分区它的上10位值(刚好就是高位的1024)和下10位值(刚好就是低位的1024), （使用二进制）:0000000001 and 0000110111。</li>
<li>添加0xD800(高位的起始位置)到上值，以形成高位：0xD800 + 0x0001 = 0xD801。</li>
<li>添加0xDC00(低位的起始位置)到下值，以形成低位：0xDC00 + 0x0037 = 0xDC37。</li>
</ol>
</li>
<li>这就是讲int类型的有效字符， 变成基本平面的char表示形式， 可能为基本平面有效字符， 或者一个高位一个低位的补充字符，由于前导代理、后尾代理、BMP中的有效字符的码位，三者互不重叠，搜索时一个字符编码的一部分不可能与另一个字符编码的不同部分相重叠。所以可以通过仅检查一个码元（构成码位的基本单位，2个字节）就可以判定给定字符的下一个字符的起始码元。</li>
</ul>
</li>
<li><p>基本平面的显示 |<strong><strong><strong><strong><strong><strong>_</strong></strong></strong></strong></strong></strong>＿＿＿＿|<strong>__</strong>＿＿＿|<strong>__</strong>＿＿|<strong>___</strong>＿＿＿＿＿|</p>
<p>​                        0                           0XD800  0XDBFF  0XDFFF         0XFFFF</p>
</li>
<li><p>从上图可以看到由于基本平面中只使用 0 - 0XD800 &amp;&amp; 0XDFFF - 0XFFFF = 65535 - 1024 <em> 2 = 63487, 而高位和地位分别占用 1024, 所以高位以及地位能够表达的值范围就是两个相乘，1024 </em> 1024 = 1048576, 所以总共的编码量应该是 63487 + 1048576 = 1112063。</p>
</li>
<li>可以看到此设计还是相当巧妙的， 它保证了整个编码来说要么使用2字节基本编码， 要么使用4字节的双字符， 并且任意的2字节单字符都可以显示出下一个字符是否是这个字符的增补。</li>
<li>总共的大小为 0X10FFFF = 1114111 = 1112063 + 1024 * 2(不映射字符)， 一个只需要int类型的21位， 那么如何将这个值映射成unicode 16中的字符就是所谓的unicode编码算法了。</li>
</ul>
</li>
<li><p>java中的char Character String之间的关系</p>
<ul>
<li>java的jvm当中字符操作使用Unicode编码， 也就是unicode16编码方式， 并且使用char 2字节来对应Unicode的基本两字节， 也就是说char就是Unicode16的基本平面， 而基本平面 = 基本平面的有效字符 （0 - 0XD800) &amp; (0XDFFF - 0XFFFF) + 高位(0XD800 - 0XDBFF) + 低位(0XDC00 - 0XDFFF)</li>
<li>char 的包装类型 Character就是包装一个简单的char值， 要么是一个有效字符， 要么是一个辅助平面的高位， 要么是辅助平面的低位， 并且它提供了很多的方法去判断当前char是否是一个有效字符， 是否是一个高位或者低位。</li>
<li>对于Character中有些方法只支持char类型参数， 表示支持基本平面的操作， 有的方法提供了int类型数和char类型参数表示支持所有的unicode 16字符的操作。</li>
<li>对于String来说它使用char[]数组作为底层的表示形式， 如果一个char是高位， 那么它的下一个char就应该是低位， 不然就不能表示一个字符了。也就是说它是unicode 16编码的， 如果要将其变成其它的编码需要对其进行转换。</li>
<li>通常情况下我们在内存中使用unicode16编码， 内存中空间和时间的一个权衡； 并且在存储的时候转换成对于语言的编码(如GBK)，更加节省磁盘； 在传输的时候使用utf8编码， 方便支持多语言并且更加节省带宽。</li>
<li>所以通常情况下在讲磁盘上的数据读取到内存当中时候，读取的是byte类型的数组， 首先讲数据转换成jvm使用unicode 16编码， 并且在处理之后写入到磁盘中时， 转换成具体编码的字节流并写入到磁盘。</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/tools-tmuxinator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/26/tools-tmuxinator/" itemprop="url">tmuxinator安装与使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-26T17:39:17+08:00">
                2019-09-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  677
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>安装tmuxinator<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/tmuxinator/tmuxinator</span><br><span class="line">sudo apt-get install ruby-full</span><br><span class="line">sudo gem install tmuxinator</span><br><span class="line">设置编辑器， 由于tmuxinator编辑项目</span><br><span class="line">$EDITOR = vim</span><br><span class="line">tmuxinator默认的存放项目位置</span><br><span class="line">~/.config/tmuxinator</span><br><span class="line">配置zsh命令简写和自动完成 TAB键</span><br><span class="line">a. 在.zshrc中添加</span><br><span class="line">source ~/.bin/tmuxinator.zsh</span><br><span class="line">b. 拷贝自动完成脚本</span><br><span class="line">cp ~/.bin/tmuxinator.fish ~/.config/fish/completions/</span><br><span class="line">注意：如果不存在~/.bin目录，那么自己下载到这个文件夹</span><br><span class="line">文件路径 https://github.com/tmuxinator/tmuxinator/tree/master/completion/</span><br></pre></td></tr></table></figure></p>
<p>基本命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tmuxinator new/edit/open project		创建/编辑/打开项目， 可以使用n/e/o简洁表示</span><br><span class="line">tmuxinator start [PROJECT] [ARGS]	启动一个项目</span><br><span class="line">tmuxinator stop [PROJECT]			停止一个项目</span><br><span class="line">tmuxinator list						显示所有项目</span><br><span class="line">tmuxinator delete [PROJECT1] [PROJECT2]	删除一个或者多个项目</span><br><span class="line">tmuxinator copy [EXISTING] [NEW]		复制一个项目</span><br><span class="line">tmuxinator debug [PROJECT] [ARGS]	debug一个项目</span><br></pre></td></tr></table></figure></p>
<p>示例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># 项目名称</span><br><span class="line">name: sample</span><br><span class="line"># 项目主目录</span><br><span class="line">root: ~/</span><br><span class="line"># 所有的窗口创建之前执行的命令</span><br><span class="line">pre_window: echo &quot;hello world&quot;</span><br><span class="line"></span><br><span class="line"># 所有的windows</span><br><span class="line">windows:</span><br><span class="line">    # windows 1 editor, 指定名字为myeditor</span><br><span class="line">    - editor: myeditor</span><br><span class="line">        # 指定当前window的主目录</span><br><span class="line">        root: ~/projects/editor</span><br><span class="line">        # layout 指定当前window的排版方式， 默认有5种</span><br><span class="line">        # 也可以自己定制， 方法在下面</span><br><span class="line">        layout: main-vertical</span><br><span class="line">        # 当前windows下所有的panes， 使用layout指定的排版方式排版</span><br><span class="line">        panes:</span><br><span class="line">            # 面板一， 此面板只有命令vim， 所以这样写就可以了</span><br><span class="line">            - vim</span><br><span class="line">            # 面板二， 此面板存在多一个命令， 将多个命令回车添加</span><br><span class="line">            # 必须上一个命令执行成功才会执行下一个命令</span><br><span class="line">            - logs:</span><br><span class="line">                - ssh logs@example.com</span><br><span class="line">                - cd /var/logs</span><br><span class="line">                - tail -f development.log</span><br><span class="line">    # window 2， 可以看到单个窗口一个命令， 直接写就可以了</span><br><span class="line">    - server: bundle exec rails s</span><br><span class="line">    # window 3， 同上</span><br><span class="line">    - logs: tail -f log/development.log</span><br></pre></td></tr></table></figure></p>
<p>使用环境变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root: &lt;%= ENV[&quot;MY_CUSTOM_DIR&quot;] %&gt;</span><br></pre></td></tr></table></figure></p>
<p>使用参数传递</p>
<ol>
<li><p>位置参数</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tmuxinator start project foo</span><br><span class="line"># 此处的args[0]就是foo</span><br><span class="line">root: ~/&lt;%= @args[0] %&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>命名参数</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tmuxinator start project workspace=workspace/todo</span><br><span class="line"># 此处的workspace 就是上面设置的值workspace/todo</span><br><span class="line">root: ~/&lt;%= @settings[&quot;workspace&quot;] %&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>tmux默认5种layout<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">even-horizontal</span><br><span class="line">even-vertical</span><br><span class="line">main-horizontal</span><br><span class="line">main-vertical</span><br><span class="line">tiled</span><br></pre></td></tr></table></figure></p>
<p>tmux自定义layout</p>
<ol>
<li><p>打印layout</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tmux list-windows</span><br><span class="line">1: bash* (4 panes) [211x47] [layout 9a0a,211x47,0,0&#123;110x47,0,0,12,100x47,111,0[100x23,111,0,13,100x23,111,24&#123;49x23,111,24,14,50x23,161,24,15&#125;]&#125;] @3 (active)</span><br></pre></td></tr></table></figure>
</li>
<li><p>截取layout</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9a0a,211x47,0,0&#123;110x47,0,0,12,100x47,111,0[100x23,111,0,13,100x23,111,24&#123;49x23,111,24,14,50x23,161,24,15&#125;]&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置layout</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">layout:9a0a,211x47,0,0&#123;110x47,0,0,12,100x47,111,0[100x23,111,0,13,100x23,111,24&#123;49x23,111,24,14,50x23,161,24,15&#125;]&#125;</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/tools-tmux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/26/tools-tmux/" itemprop="url">tmux安装与使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-26T17:36:25+08:00">
                2019-09-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,047
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>安装tmux</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/gpakosz/.tmux</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置tmux</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">set-option -g allow-rename off</span><br><span class="line">每一次窗口执行不同的命令窗口的名字就会发生变化， 此处是关闭自动命名</span><br><span class="line">set-window-option -g pane-base-index 1</span><br><span class="line">设置窗口pane的下标从1开始</span><br><span class="line"># on Linux, this requires xsel or xclip</span><br><span class="line">tmux_conf_copy_to_os_clipboard=true</span><br><span class="line">设置tmux剪切板与系统剪切板同步</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用tmux</p>
<ol>
<li>tmux使用来管理回话并提供分屏等功能的软件， 当tmux开启时， 就会启动一个tmux-server的程序，用来管理上面所有的session会话， 每个session会话中可以存在多个windows（窗口）， 每个窗口又存在多个panel（面板）</li>
<li><p>tmux命令</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tmux + tab				列出所有tmux可以使用的命令</span><br><span class="line">tmux new-session -s name		创建session</span><br><span class="line">tmux list-session			查看session</span><br><span class="line">tmux attach-session name	attach到某个session</span><br><span class="line">tmux kill-session name		杀死某个session</span><br><span class="line">tmux info 				查看session, window, pane, 运行的进程号</span><br><span class="line">tmux list-keys 				列出所有可以的快捷键和其运行的 tmux 命令</span><br><span class="line">tmux list-commands 		列出所有的 tmux 命令及其参数</span><br><span class="line">tmux kill-server 关闭所有 session</span><br></pre></td></tr></table></figure>
<p> <em>注意</em> 所有的上面这些命令在没进入某个session之前直接使用tmux command args来调用， 当进如了tmux之后直接在任何的panel中通过 <code>&lt;pre&gt; + : +command args</code>来激活命令行操作， 此时所有的命令只需要使用 command args就可以调用了</p>
</li>
<li><p>tmux 基本操作</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">? 列出所有快捷键；按q返回</span><br><span class="line">d 脱离当前会话,可暂时返回Shell界面</span><br><span class="line">s 选择并切换会话；在同时开启了多个会话时使用</span><br><span class="line">: 进入命令行模式；此时可输入支持的命令，例如 kill-server 关闭所有tmux会话, rename 重命名当前session</span><br><span class="line">[ 复制模式，光标移动到复制内容位置，空格键开始，方向键选择复制，回车确认，q/Esc退出， 可以设置vi模式复制</span><br><span class="line">] 进入粘贴模式，粘贴之前复制的内容，按q/Esc退出</span><br><span class="line">t 显示当前的时间</span><br></pre></td></tr></table></figure>
</li>
<li><p>tmux 窗口操作</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c 创建新窗口</span><br><span class="line">&amp; 关闭当前窗口</span><br><span class="line">[0-9] 数字键切换到指定窗口</span><br><span class="line">ctrl + h/l 左右切换窗口（安装ctrl， 并快速的按h/l）</span><br><span class="line">w 通过窗口列表切换窗口</span><br><span class="line">, 重命名当前窗口，便于识别</span><br><span class="line">. 修改当前窗口编号，相当于重新排序</span><br><span class="line">f 在所有窗口中查找关键词，便于窗口多了切换</span><br></pre></td></tr></table></figure>
</li>
<li><p>tmux 面板操作</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&quot;/- 将当前面板上下分屏</span><br><span class="line">%/_ 将当前面板左右分屏</span><br><span class="line">x 关闭当前分屏</span><br><span class="line">! 将当前面板置于新窗口,即新建一个窗口,其中仅包含当前面板</span><br><span class="line">z 最大化当前所在面板</span><br><span class="line">ctrl+方向键 以1个单元格为单位移动边缘以调整当前面板大小</span><br><span class="line">alt+方向键 以5个单元格为单位移动边缘以调整当前面板大小</span><br><span class="line">H/J/K/L 以1个单元格移动边缘以调整当前面板大小</span><br><span class="line">q 显示面板编号</span><br><span class="line">o 选择当前窗口中下一个面板</span><br><span class="line">方向键/h/j/k/l 移动光标选择对应面板</span><br><span class="line">&#123; 向前置换当前面板</span><br><span class="line">&#125; 向后置换当前面板</span><br><span class="line">alt+o 逆时针旋转当前窗口的面板</span><br><span class="line">ctrl+o 顺时针旋转当前窗口的面板</span><br></pre></td></tr></table></figure>
</li>
<li><p>tmux 滚屏操作，由于tmux接管如果输出大量的数据无法看到上面屏幕的字， 如果此时鼠标操作关闭，那么当使用鼠标滑轮的时候显示的执行过命令的显示， 而不能屏幕翻页， 要想达到这个目的有两个办法：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">打开鼠标操作， 使用滑轮上下翻页 &lt;pre&gt; + m</span><br><span class="line">打开复制模式， 使用vi的翻滚策略来操作， 此时又会碰到一个问题， 如果前缀是ctrl + b那么不好往下整页翻滚， 建议使用半屏翻滚 ctrl + u / d(f)</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/tools-zsh/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/26/tools-zsh/" itemprop="url">zsh安装与使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-26T17:34:15+08:00">
                2019-09-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  178
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>安装zsh</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install zsh    #安装zsh</span><br><span class="line">chsh -s /bin/zsh            #不需要sudo，重启</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装oh-my-zsh</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/robbyrussell/oh-my-zsh</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装zsh插件</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vi-mode</span><br><span class="line">autojump 				        需要安装软件</span><br><span class="line">zsh-autosuggestions 	  https://github.com/zsh-users/zsh-autosuggestions</span><br><span class="line">last-working-dir        </span><br><span class="line">d						            在终端输入d 显示最近频繁进入的路径，然后输入路径前对应的序号可快速进入对应路径</span><br><span class="line">history					        用法：在终端输入h即可</span><br><span class="line">zsh-syntax-highlighting	https://github.com/zsh-users/zsh-syntax-highlighting</span><br><span class="line">web-search				      如：google StackOverflow， 指定搜搜引擎就可以了</span><br><span class="line">sublime					        需要安装软件， [s]st [|文件|文件夹] [管理员]打开 [当前目录|文件|文件夹]</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/tools-vim/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/26/tools-vim/" itemprop="url">vim 安装和使用技巧</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-26T17:25:06+08:00">
                2019-09-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,043
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="vim使用"><a href="#vim使用" class="headerlink" title="vim使用"></a>vim使用</h4><ul>
<li><p>16进制编辑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">使用vim 打开需要编辑的文件， 如： Hello.class</span><br><span class="line">	vim -b Hello.class</span><br><span class="line">进入xxd转换程序模式</span><br><span class="line">	:%!xxd</span><br><span class="line">查找并修改文件16进制部分</span><br><span class="line">退出xxd转换程序模式（必须退出， 不然以xxd显示进行保存）</span><br><span class="line">	:%!xxd -r</span><br><span class="line">推出vim</span><br><span class="line">	:wq</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="原生vim"><a href="#原生vim" class="headerlink" title="原生vim"></a>原生vim</h4><ol>
<li>更新vim到最新版本 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:jonathonf/vim</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="2">
<li>安装vim <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/amix/vimrc</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="3">
<li><p>添加自动更新到crontab中</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 */6 * * * cd /home/feng/.vim_runtime &amp;&amp; git pull --rebase &gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="4">
<li><p>插件快捷键讲解</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ack.vim         内容搜索      &lt;leader&gt; + g</span><br><span class="line">ctrlp.vim       文件搜索      &lt;leader&gt; + j</span><br><span class="line">bufexplorer.zip 缓存查看      &lt;leader&gt; + o</span><br><span class="line">mru.vim         最近文件      &lt;leader&gt; + f</span><br><span class="line">NERD Tree       文件目录      &lt;leader&gt; + nn</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="使用neovim-vim的替代品-推荐"><a href="#使用neovim-vim的替代品-推荐" class="headerlink" title="使用neovim(vim的替代品,推荐)"></a>使用neovim(vim的替代品,推荐)</h4><ol>
<li><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install software-properties-common</span><br><span class="line">sudo add-apt-repository ppa:neovim-ppa/stable</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install neovim</span><br><span class="line">sudo apt-get install python-dev python-pip python3-dev python3-pip</span><br><span class="line">sudo update-alternatives --install /usr/bin/vi vi /usr/bin/nvim 60</span><br><span class="line">sudo update-alternatives --config vi</span><br><span class="line">sudo update-alternatives --install /usr/bin/vim vim /usr/bin/nvim 60</span><br><span class="line">sudo update-alternatives --config vim</span><br><span class="line">sudo update-alternatives --install /usr/bin/editor editor /usr/bin/nvim 60</span><br><span class="line">sudo update-alternatives --config editor</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">call plug#begin(&apos;~/.local/share/nvim/plugged&apos;)</span><br><span class="line">Plug &apos;vim-airline/vim-airline&apos;</span><br><span class="line">Plug &apos;majutsushi/tagbar&apos;</span><br><span class="line">Plug &apos;kien/ctrlp.vim&apos;</span><br><span class="line">Plug &apos;tacahiroy/ctrlp-funky&apos;</span><br><span class="line">Plug &apos;mileszs/ack.vim&apos;</span><br><span class="line">Plug &apos;yegappan/mru&apos;</span><br><span class="line">Plug &apos;ianva/vim-youdao-translater&apos;</span><br><span class="line">Plug &apos;yonchu/accelerated-smooth-scroll&apos;</span><br><span class="line">Plug &apos;jlanzarotta/bufexplorer&apos;</span><br><span class="line">Plug &apos;mhinz/vim-startify&apos;</span><br><span class="line">Plug &apos;scrooloose/nerdtree&apos;, &#123; &apos;on&apos;:  &apos;NERDTreeToggle&apos; &#125;</span><br><span class="line">Plug &apos;easymotion/vim-easymotion&apos;</span><br><span class="line">Plug &apos;Valloric/YouCompleteMe&apos;</span><br><span class="line">call plug#end()</span><br><span class="line"></span><br><span class="line">set nobackup</span><br><span class="line">set nowb</span><br><span class="line">set noswapfile</span><br><span class="line">&quot;set number</span><br><span class="line">nnoremap &lt;F5&gt; :set nonumber!&lt;CR&gt;:set foldcolumn=0&lt;CR&gt;  &lt;Paste&gt;</span><br><span class="line">set hlsearch</span><br><span class="line">set ignorecase</span><br><span class="line">set incsearch</span><br><span class="line">set smartcase</span><br><span class="line">filetype plugin indent on</span><br><span class="line">set tabstop=4</span><br><span class="line">set softtabstop=4</span><br><span class="line">set shiftwidth=4</span><br><span class="line">set expandtab</span><br><span class="line"></span><br><span class="line">&quot;快捷键的映射，通过不同的前缀定义快捷键在那种模式下启动</span><br><span class="line">&quot;nore前缀   非递归</span><br><span class="line">&quot;n前缀      普通实施生效</span><br><span class="line">&quot;v前缀      可视模式生效</span><br><span class="line">&quot;i前缀      插入模式生效</span><br><span class="line">&quot;c前缀      在EX命令模式生效</span><br><span class="line"></span><br><span class="line">&quot;定义前缀键</span><br><span class="line">:let mapleader=&quot;;&quot;</span><br><span class="line"></span><br><span class="line">&quot;定义NERDTree出发快捷键</span><br><span class="line">map &lt;F2&gt; :NERDTreeToggle&lt;CR&gt;</span><br><span class="line">autocmd bufenter * if (winnr(&quot;$&quot;) == 1 &amp;&amp; exists(&quot;b:NERDTree&quot;) &amp;&amp; b:NERDTree.isTabTree()) | q | endif</span><br><span class="line"></span><br><span class="line">&quot;定义文件结构快捷键</span><br><span class="line">nmap &lt;F3&gt; :TagbarToggle&lt;CR&gt;</span><br><span class="line"></span><br><span class="line">&quot;定义文件搜索相关</span><br><span class="line">&quot;let g:ctrlp_map = &apos;&lt;c-p&gt;&apos;</span><br><span class="line">let g:ctrlp_map = &apos;&lt;F8&gt;&apos;</span><br><span class="line">let g:ctrlp_cmd = &apos;CtrlP&apos;</span><br><span class="line">let g:ctrlp_working_path_mode = &apos;ra&apos;</span><br><span class="line">set wildignore+=*/tmp/*,*.so,*.swp,*.zip</span><br><span class="line">let g:ctrlp_custom_ignore = &#123;</span><br><span class="line">  \ &apos;dir&apos;:  &apos;\v[\/]\.(git|hg|svn)$&apos;,</span><br><span class="line">  \ &apos;file&apos;: &apos;\v\.(exe|so|dll)$&apos;,</span><br><span class="line">  \ &apos;link&apos;: &apos;some_bad_symbolic_links&apos;,</span><br><span class="line">  \ &#125;</span><br><span class="line">let g:ctrlp_user_command = [&apos;.git&apos;, &apos;cd %s &amp;&amp; git ls-files -co --exclude-standard&apos;]</span><br><span class="line">let g:ctrlp_working_path_mode=0</span><br><span class="line">let g:ctrlp_match_window_bottom=1</span><br><span class="line">let g:ctrlp_max_height=15</span><br><span class="line">let g:ctrlp_match_window_reversed=0</span><br><span class="line">let g:ctrlp_mruf_max=500</span><br><span class="line">let g:ctrlp_follow_symlinks=1</span><br><span class="line">&quot;ctrl + j/k 进行上下选择</span><br><span class="line">&quot;ctrl + x 在当前窗口水平分屏打开文件</span><br><span class="line">&quot;ctrl + v 同上, 垂直分屏</span><br><span class="line">&quot;ctrl + t 在tab中打开</span><br><span class="line"></span><br><span class="line">&quot;定义文件中搜索函数</span><br><span class="line">nnoremap &lt;Leader&gt;f :CtrlPFunky&lt;Cr&gt;</span><br><span class="line">nnoremap &lt;Leader&gt;fu :execute &apos;CtrlPFunky &apos; . expand(&apos;&lt;cword&gt;&apos;)&lt;Cr&gt;</span><br><span class="line">let g:ctrlp_funky_syntax_highlight = 1</span><br><span class="line">let g:ctrlp_extensions = [&apos;funky&apos;]</span><br><span class="line"></span><br><span class="line">&quot;定义内容搜索快捷键</span><br><span class="line">let g:ackprg = &apos;ag --nogroup --nocolor --column&apos;</span><br><span class="line">map &lt;F7&gt; :Ack&lt;space&gt;</span><br><span class="line">if executable(&apos;ag&apos;)</span><br><span class="line">  &quot; Use Ag over Grep</span><br><span class="line">  set grepprg=ag\ --nogroup\ --nocolor</span><br><span class="line"></span><br><span class="line">  &quot; Use ag in CtrlP for listing files. Lightning fast and respects .gitignore</span><br><span class="line">  let g:ctrlp_user_command = &apos;ag %s -l --nocolor -g &quot;&quot;&apos;</span><br><span class="line"></span><br><span class="line">  &quot; ag is fast enough that CtrlP doesn&apos;t need to cache</span><br><span class="line">  let g:ctrlp_use_caching = 0</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line">&quot;定义缓冲文件快捷键</span><br><span class="line">nnoremap &lt;silent&gt; &lt;F9&gt; :BufExplorer&lt;CR&gt;</span><br><span class="line"></span><br><span class="line">&quot;定义最近文件快捷键</span><br><span class="line">nnoremap &lt;silent&gt; &lt;F10&gt; :MRU&lt;CR&gt;</span><br><span class="line">let MRU_Window_Height = 10</span><br><span class="line">&quot;jk          # 在历史记录列表中上下移动</span><br><span class="line">&quot;Enter       # 进入相应文件</span><br><span class="line">&quot;o       # 水平方向打开</span><br><span class="line">&quot;t           # 在新标签中打开历史文件</span><br><span class="line">&quot;u           # 更新文件列表</span><br><span class="line">&quot;q           # 退出MRU历史记录</span><br><span class="line">&quot;v           # 以只读模式打开</span><br><span class="line">&quot;/           # 在MRU列表中快速查找</span><br><span class="line"></span><br><span class="line">&quot;定义有道翻译快捷键</span><br><span class="line">vnoremap &lt;silent&gt; &lt;C-T&gt; :&lt;C-u&gt;Ydv&lt;CR&gt;</span><br><span class="line">nnoremap &lt;silent&gt; &lt;C-T&gt; :&lt;C-u&gt;Ydc&lt;CR&gt;</span><br><span class="line">noremap &lt;leader&gt;yd :&lt;C-u&gt;Yde&lt;CR&gt;</span><br><span class="line"></span><br><span class="line">&quot;定义跳转快捷键</span><br><span class="line">map  &lt;Leader&gt;w &lt;Plug&gt;(easymotion-bd-w)</span><br><span class="line">nmap &lt;Leader&gt;w &lt;Plug&gt;(easymotion-overwin-w)</span><br><span class="line"></span><br><span class="line">&quot;YouCompleteMe快捷键</span><br><span class="line">nnoremap &lt;leader&gt;gl :YcmCompleter GoToDeclaration&lt;CR&gt;</span><br><span class="line">nnoremap &lt;leader&gt;gf :YcmCompleter GoToDefinition&lt;CR&gt;</span><br><span class="line">nnoremap &lt;leader&gt;gg :YcmCompleter GoToDefinitionElseDeclaration&lt;CR&gt;</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/26/tools-sublime/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ilivoo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my-icon.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ilivoo`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/26/tools-sublime/" itemprop="url">sublime安装与使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-26T17:32:08+08:00">
                2018-09-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  187
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>安装直接网上搜索，并对其破解</p>
</li>
<li><p>插件安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. ConvertToUTF8 和 GBK Support</span><br><span class="line">2. Pretty Json</span><br><span class="line">3. SideBarEnhancements</span><br><span class="line">4. vim</span><br><span class="line">5. MarkdownPreview</span><br></pre></td></tr></table></figure>
</li>
<li><p>快捷键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、使用Ctrl + `：打开或者关闭Sublime Text控制台。SublimeText控制台就是一个python的命令窗口。</span><br><span class="line">2、Ctrl+Shift+P：打开或者关闭命令行模式。</span><br><span class="line">3、Alt+Shift+2：分屏显示。( Alt+Shift+数字 )表示分几屏。默认即1，最大貌似是5。</span><br><span class="line">4、Sublime Text的一大亮点是支持多重选择——同时选择多个区域，然后同时进行编辑。Ctrl + D选择当前光标所在的词并高亮该词所有出现的位置，再次Ctrl + D选择该词出现的下一个位置。</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>
    <div>
        
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/my-icon.jpeg"
                alt="ilivoo" />
            
              <p class="site-author-name" itemprop="name">ilivoo</p>
              <p class="site-description motion-element" itemprop="description">我，在這裡，享受等你的時光。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">50</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ilivoo</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  <script type="text/javascript" src="/lib/clipboard/clipboard.js"></script>
<script type="text/javascript" src="/js/src/custom.js"></script>

</body>
</html>
